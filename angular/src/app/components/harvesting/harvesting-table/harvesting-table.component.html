<div class="table-container">
  <div class="loading-shade" *ngIf="isLoadingResults">
    <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
  </div>

  <div class="table-content-container">
    <table mat-table [dataSource]="dataSource" matSort>
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header #id>ID</th>
        <td mat-cell *matCellDef="let harvesting">
          {{ harvesting.id }}
        </td>
      </ng-container>

      <ng-container matColumnDef="harvestedSize">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          i18n
          #harvestedSize
        >
          Harvested records
        </th>
        <td mat-cell *matCellDef="let harvesting">
          {{ harvesting.harvestedSize | number }}
        </td>
      </ng-container>

      <ng-container matColumnDef="validSize">
        <th mat-header-cell *matHeaderCellDef mat-sort-header i18n #validSize>
          Valid records
        </th>
        <td mat-cell *matCellDef="let harvesting">
          {{ harvesting.validSize | number }}
        </td>
      </ng-container>

      <ng-container matColumnDef="transformedSize" *ngIf="admUser">
        <th mat-header-cell *matHeaderCellDef mat-sort-header i18n #transformedSize>
          Transformed records
        </th>
        <td mat-cell *matCellDef="let harvesting">
          {{ harvesting.transformedSize | number }}
        </td>
      </ng-container>

      <ng-container matColumnDef="invalidRecords">
        <th
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          i18n
          #invalidRecords
        >
          Invalid records
        </th>
        <td mat-cell *matCellDef="let harvesting">
          {{ harvesting.invalidRecords | number }}
        </td>
      </ng-container>

      <ng-container matColumnDef="startTime">
        <th mat-header-cell *matHeaderCellDef mat-sort-header i18n #startTime>
          Start
        </th>
        <td mat-cell *matCellDef="let harvesting">
          {{ harvesting.startTime | date: 'short' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="endTime">
        <th mat-header-cell *matHeaderCellDef mat-sort-header i18n #endTime>
          End
        </th>
        <td mat-cell *matCellDef="let harvesting">
          {{ harvesting.endTime | date: 'short' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="button">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let harvesting">
          <span i18n class="badge badge-secondary" *ngIf="harvesting.deleted">
            Not available
          </span>
          <button
            *ngIf="!harvesting.deleted"
            type="button"
            class="btn btn-outline-primary"
            (click)="detailClick(harvesting)"
            i18n
          >
            Validations
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <mat-paginator
      #paginator
      [pageIndex]="0"
      [pageSize]="pageSize"
      [pageSizeOptions]="[10, 25, 50, 100, 250]"
    >
    </mat-paginator>
  </div>
  <app-table-exporter
    [data]="csvData"
    [header]="headerData"
  ></app-table-exporter>
</div>
